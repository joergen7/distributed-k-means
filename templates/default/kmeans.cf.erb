



deftask gen_data( data( File ) state0( File ) : N k ) in python *{

import numpy as np
import random

N = int( N )
k = int( k )

n = float(N)/k
X = []
for i in range(k):
  c = (random.uniform(-1, 1), random.uniform(-1, 1))
  s = random.uniform(0.05,0.5)
  x = []
  while len(x) < n:
    a, b = np.array([np.random.normal(c[0], s), np.random.normal(c[1], s)])
    if abs(a) < 1 and abs(b) < 1:
      x.append([a,b])
  X.extend(x)
X = np.array(X)[:N]

mu0 = random.sample( X, k )

data = "data.npy"
np.save( data, X )
state0 = "state0.npy"
np.save( state0, mu0 )
}*

deftask cluster_points( cls( File ) : data( File ) state( File ) ) in python *{

import numpy as np

X = np.load( data )
mu = np.load( state )

clusters  = {}
for x in X:
  bestmukey = min( [(i[ 0 ], np.linalg.norm( x-mu[ i[ 0 ] ] ) ) \
    for i in enumerate( mu )], key=lambda t:t[ 1 ])[ 0 ]
  try:
    clusters[ bestmukey ].append(x)
  except KeyError:
    clusters[ bestmukey ] = [ x ]

cls = "cls.npy"
np.save( cls, clusters )
}*

k = 4;
N = 800;

X mu0 = gen_data( N: 800, k: 4 );

clusters = cluster_points( data: X, state: mu0 );

clusters;